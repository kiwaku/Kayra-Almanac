---
import Base from '../layouts/SectionLayout.astro';
import { getCollection } from 'astro:content';
const parts = await getCollection('hardware');
const grouped = parts.reduce((acc, p) => {
  (acc[p.data.part] ||= []).push(p);
  return acc;
}, {} as Record<string, typeof parts>);

// Generate markdown
const rawMarkdown = `# Hardware â€” Hephaestus

${Object.entries(grouped).map(([part, list]) => `## ${part.charAt(0).toUpperCase() + part.slice(1)}

${list.map(entry => `### ${entry.data.title}

${entry.body}${entry.data.images ? `

Images: ${entry.data.images.join(', ')}` : ''}
`).join('\n')}`).join('\n')}`;
---
<Base title="Hardware â€” Hephaestus" rawMarkdown={rawMarkdown}>
  <h1>Hardware: Hephaestus</h1>
  {Object.entries(grouped).map(async ([part, list]) => (
    <>
      {list.map(async (entry) => {
        const { Content } = await entry.render();
        return (
          <article class="card">
            <Content />
          </article>
        );
      })}
    </>
  ))}
</Base>
