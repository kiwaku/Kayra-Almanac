---
import '../styles/theme.css';
import LeftNav from '../components/LeftNav.astro';
import ProofStrip from '../components/ProofStrip.astro';
const { title = 'Kayra — Workshop Almanac' } = Astro.props;
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Workshop Almanac: security, OS builds, AI eval, hardware logs.">
    <link rel="icon" href="/favicon.ico" />
    <meta property="og:type" content="website">
    <meta property="og:title" content="Kayra — Workshop Almanac">
    <meta property="og:description" content="Security, OS builds, AI eval, hardware logs.">
    <meta property="og:image" content="/og-default.jpg">
  </head>
  <body>
    <header class="header">
      <div class="brand">Kayra — <span class="muted">Workshop Almanac</span></div>
      <nav class="topnav">
        <a href="/start-here" data-portal>Start Here</a>
        <a href="/catalog" data-portal>Catalog</a>
        <a href="/logbook" data-portal>Logbook</a>
        <a href="/hardware" data-portal>Hardware</a>
        <a href="/notebooks" data-portal>Notebooks</a>
        <a href="/gallery" data-portal>Gallery</a>
        <a href="/shrine" class="shrine" aria-label="Shrine (anomaly link)">⛩</a>
      </nav>
    </header>

    <ProofStrip />

    <main class="shell">
      <aside class="left">
        <LeftNav />
      </aside>
      <section class="content">
        <slot />
        <details class="raw"><summary>Raw Markdown</summary><!-- pre-embed at build if desired --></details>
      </section>
    </main>

    <footer class="nav-footer">
      <nav aria-label="Footer links">
        <a href="/start-here">START HERE</a>
        <img src="/assets/dot.gif" class="dot" alt="">
        <a href="/catalog">CATALOG</a>
        <img src="/assets/dot.gif" class="dot" alt="">
        <a href="/logbook">LOGBOOK</a>
        <img src="/assets/dot.gif" class="dot" alt="">
        <a href="/hardware">HARDWARE</a>
        <img src="/assets/dot.gif" class="dot" alt="">
        <a href="/notebooks">NOTEBOOKS</a>
        <img src="/assets/dot.gif" class="dot" alt="">
        <a href="/gallery">GALLERY</a>
      </nav>
      <div class="copy"><i>© {new Date().getFullYear()} Kayra — Workshop Almanac · Evidence [E] · Raw [R]</i></div>
    </footer>

    <div class="trust">
      <a href="/trust.html" title="Content rating / About this site">
        <img src="/assets/trust-88x31.gif" width="88" height="31" alt="Content Rated">
      </a>
    </div>

    <script is:inline src="/evidence-toggle.js" defer></script>
    <script is:inline src="/raw-toggle.js" defer></script>
    <div id="portal-overlay" hidden aria-hidden="true"></div>
<script is:inline type="module">
  // Intercept top/left nav clicks tagged data-portal (no animation yet)
  function handle(e){
    if(!e.target || !(e.target instanceof Element)) return;
    const a = e.target.closest('a[data-portal]');
    if(!a) return;
    // v1: show a no-op overlay briefly to verify wiring (kept hidden instantly)
    // v2: this is where we mount the shader + screenshot, then navigate.
  }
  document.addEventListener('click', handle);
</script>

<script is:inline>
document.addEventListener('click', function(e){
  if(!e.target || !(e.target instanceof Element)) return;
  const a = e.target.closest('a.lightbox, a.thumb');
  if(!a) return;
  e.preventDefault();
  let lb = document.getElementById('lightbox');
  if(!lb){
    lb = document.createElement('div');
    lb.id = 'lightbox';
    lb.innerHTML = '<img alt=""><button aria-label="Close">×</button>';
    document.body.appendChild(lb);
    lb.addEventListener('click', function(){ if(lb) lb.hidden = true; });
  }
  const img = lb.querySelector('img');
  if(img && a instanceof HTMLAnchorElement) img.src = a.href;
  lb.hidden = false;
});
</script>
  </body>
</html>
